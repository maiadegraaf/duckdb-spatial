# name: test/sql/gdal/st_read_gdb.test
# group: [gdal]

require spatial

statement error
COPY (SELECT ST_Point(1,2) as geom, 10 as i) TO '__TEST_DIR__/test.gdb' WITH (FORMAT 'GDAL', DRIVER 'OpenFileGDB');
----
OpenFileGDB requires 'GEOMETRY_TYPE' parameter to be set when writing

statement error
COPY (SELECT ST_Point(1,2) as geom, 10 as i) TO '__TEST_DIR__/test_fail.gdb' WITH (FORMAT 'GDAL', DRIVER 'OpenFileGDB', GEOMETRY_TYPE 'LINESTRING');
----
Not implemented Error: Can only insert a LineString/MultiLineString/CircularString/CompoundCurve/MultiCurve in a esriGeometryLine layer

statement ok
COPY (SELECT ST_Point(1,2) as geom, 10 as i) TO '__TEST_DIR__/test.gdb' WITH (FORMAT 'GDAL', DRIVER 'OpenFileGDB', GEOMETRY_TYPE 'POINT');

query II
FROM st_read('__TEST_DIR__/test.gdb');
----
10	POINT (1 2)