require spatial

# Test identical points - extents should intersect
query I
SELECT
    ST_Intersects_Extent(
        ST_Point(0, 0),
        ST_Point(0, 0)
    )
----
true

# Test disjoint points - extents should not intersect
query I
SELECT
    ST_Intersects_Extent(
        ST_Point(0, 0),
        ST_Point(1, 1)
    )
----
false

# Test overlapping linestrings - extents should intersect
query I
SELECT
    ST_Intersects_Extent(
        ST_GeomFromText('LINESTRING(0 0, 2 2)'),
        ST_GeomFromText('LINESTRING(1 0, 1 2)')
    )
----
true

# Test overlapping polygons - extents should intersect
query I
SELECT
    ST_Intersects_Extent(
        ST_GeomFromText('POLYGON ((0 0, 0 2, 2 2, 0 0))'),
        ST_GeomFromText('POLYGON ((1 1, 1 2, 2 2, 1 1))')
    )
----
true

# Test disjoint polygons - extents should not intersect
query I
SELECT
    ST_Intersects_Extent(
        ST_GeomFromText('POLYGON ((0 0, 0 -2, -2 -2, 0 0))'),
        ST_GeomFromText('POLYGON ((1 1, 1 2, 2 2, 1 1))')
    )
----
false
